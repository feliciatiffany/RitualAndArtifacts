/* ============================================
   ELEVATOR BET GAME - Comic Book Style
   ============================================ */

@import url('https://fonts.googleapis.com/css2?family=Bangers&display=swap');

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html {
    -webkit-tap-highlight-color: transparent;
}

body {
    font-family: 'Bangers', cursive;
    background: #000;
    margin: 0;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    cursor: default;
    -webkit-user-select: none;
    user-select: none;
}

#game-viewport {
    width: 800px;
    height: 400px;
    position: relative;
    overflow: hidden;
    transform-origin: center center;
    transform: scale(min(1, 100vw / 800, 100vh / 400));
    background: #3a3520;
}

/* ============================================
   SCREEN SYSTEM
   ============================================ */
.screen {
    display: none;
    position: absolute;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
}

.screen.active {
    display: block;
    z-index: 10;
}

/* Confirm screen entrance (MAKE YOUR BET -> Confirm, direct switch) */
.screen.confirm-entering {
    animation: confirmScreenReveal 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

.screen.confirm-entering .confirm-bg {
    animation: confirmEnter 0.55s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    transform-origin: center center;
}

@keyframes confirmScreenReveal {
    0% { opacity: 0; }
    100% { opacity: 1; }
}

@keyframes confirmEnter {
    0% { opacity: 0; transform: scale(0.5) rotate(5deg); filter: blur(4px); }
    60% { opacity: 1; transform: scale(1.08) rotate(-1deg); filter: blur(0); }
    100% { opacity: 1; transform: scale(1) rotate(0deg); filter: blur(0); }
}

/* ============================================
   COMIC TYPOGRAPHY
   ============================================ */
.comic-title {
    font-family: 'Bangers', cursive;
    letter-spacing: 3px;
    text-transform: uppercase;
    line-height: 1.1;
}

.comic-subtitle {
    font-family: 'Bangers', cursive;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: #fff;
    text-shadow: 2px 2px 0 #000;
}

/* ============================================
   SCREEN 1: START
   ============================================ */
.start-bg {
    width: 100%;
    height: 100%;
    min-height: 100%;
    background: #2C2720 url('images/start-bg.png') center center / cover no-repeat;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    position: relative;
    overflow: hidden;
}

.start-text {
    position: absolute;
    top: 88%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 5;
    text-align: center;
    padding: 0 5%;
}

.start-subtitle {
    font-family: 'Bangers', cursive;
    font-size: clamp(16px, 3.2vw, 28px);
    margin-top: 0;
    color: #fff;
    text-shadow:
        2px 2px 0 #000,
        3px 3px 0 rgba(0,0,0,0.8),
        -1px -1px 0 #000,
        1px 1px 0 #000;
    filter: drop-shadow(2px 3px 2px rgba(0,0,0,0.5));
    letter-spacing: 4px;
    font-weight: bold;
    font-style: italic;
    animation: blink 1.8s ease-in-out infinite;
    transition: transform 0.15s ease;
}

.start-bg:active .start-subtitle {
    transform: scale(1.15);
}

.ranking-link {
    position: absolute;
    bottom: 30px;
    left: 20px;
    z-index: 6;
    background: none;
    border: none;
    font-family: 'Bangers', cursive;
    font-size: clamp(18px, 3vw, 26px);
    color: rgba(200, 185, 160, 0.9);
    letter-spacing: 3px;
    text-transform: uppercase;
    cursor: pointer;
    text-shadow: 1px 1px 0 rgba(0,0,0,0.6), 0 0 8px rgba(44,39,32,0.4);
    transition: transform 0.2s, color 0.2s, text-shadow 0.2s;
    padding: 4px 8px;
}
.ranking-link:hover {
    transform: scale(1.08);
    color: rgba(244, 220, 170, 0.95);
    text-shadow: 1px 1px 0 rgba(0,0,0,0.5), 0 0 12px rgba(244,168,37,0.3);
}
.ranking-link:active {
    transform: scale(0.98);
}

/* ============================================
   RANKING POPUP - 高度调整说明
   ============================================
   调整弹窗高度：修改 .ranking-popup-inner 的 max-height
   例：max-height: min(480px, 80vh)  → 更矮
       max-height: min(600px, 90vh)  → 更高
   调整整体高度：body/html 用 min-height: 100vh 或 100dvh
   调整元素高度：用 height / min-height / max-height
   视口单位：vh=视口高度%, vw=视口宽度%
   clamp(最小, 理想, 最大)：响应式尺寸
   ============================================ */
.ranking-popup {
    position: absolute;
    inset: 0;
    z-index: 50;
    background: rgba(26, 26, 46, 0.75);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}
.ranking-popup.active {
    opacity: 1;
    visibility: visible;
}
.ranking-popup-inner {
    position: relative;
    max-width: min(300px, 80vw);
    max-height: min(320px, 80vh);
    line-height: 0;
    font-size: 0;
    overflow: hidden;
    background: #f5d76e;
}
.ranking-popup-img {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
    min-height: 140px;
    padding: 16px;
}
.ranking-popup-img canvas,
.ranking-popup-img img {
    display: block;
}
.ranking-popup-img img {
    max-width: 100%;
    height: auto;
}
.ranking-popup-countdown {
    position: absolute;
    top: 14%;
    right: 12%;
    font-size: clamp(24px, 5vw, 40px);
    color: #1a237e;
    font-weight: bold;
}

@keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.15; }
}

/* ============================================
   SCREEN 2: ASK NAME
   ============================================ */
.name-bg {
    width: 100%;
    height: 100%;
    min-height: 100%;
    background: #f8f7ed url('images/name-bg.png') center center / 115% no-repeat;
    position: relative;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 0;
}

.name-back-btn {
    top: auto;
    bottom: max(3%, env(safe-area-inset-bottom, 12px));
    left: max(5%, env(safe-area-inset-left, 20px));
    right: auto;
    color: #2a9d8f;
    text-shadow: 1px 1px 0 rgba(255,255,255,0.5);
    min-height: 52px;
    padding: 16px 24px;
    font-size: clamp(20px, 4vw, 40px);
}
.name-back-btn:hover {
    color: #1a7a6e;
}

.name-content {
    position: absolute;
    top: 55%;
    left: 21%;
    right: 21%;
    margin: 0;
    transform: translateY(-50%);
    z-index: 5;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 18px;
}

.name-prompt {
    font-family: 'Bangers', cursive;
    font-size: clamp(22px, 4vw, 36px);
    color: #e63946;
    letter-spacing: 3px;
    text-shadow: 2px 2px 0 #000, 1px 1px 0 rgba(0,0,0,0.8);
    margin-bottom: 8px;
}

.animal-options {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    justify-content: center;
    align-items: center;
    width: 100%;
    max-width: 420px;
}

.animal-btn {
    background: rgba(255,255,255,0.9);
    border: 2px solid #2a9d8f;
    border-radius: 20px;
    padding: 12px 24px;
    font-family: 'Bangers', cursive;
    font-size: clamp(18px, 3.5vw, 26px);
    color: #2a9d8f;
    cursor: pointer;
    letter-spacing: 2px;
    transition: all 0.2s;
}

.animal-btn:hover {
    background: #2a9d8f;
    color: #fff;
    transform: scale(1.08);
}

.animal-btn.taken {
    background: rgba(150,150,150,0.5);
    border-color: #666;
    color: #999;
    cursor: not-allowed;
    transform: none;
}

.animal-btn.taken:hover {
    background: rgba(150,150,150,0.5);
    color: #999;
}

.name-warning {
    font-family: 'Bangers', cursive;
    font-size: 16px;
    color: #e63946;
    background: rgba(230, 57, 70, 0.15);
    border: 2px solid #e63946;
    border-radius: 10px;
    padding: 8px 20px;
    letter-spacing: 1px;
    text-align: center;
    width: 100%;
    box-sizing: border-box;
    animation: shake 0.4s ease;
}

.next-btn {
    position: absolute;
    bottom: max(3%, env(safe-area-inset-bottom, 12px));
    right: max(5%, env(safe-area-inset-right, 20px));
    z-index: 10;
    background: none;
    border: none;
    font-family: 'Bangers', cursive;
    font-size: clamp(20px, 4vw, 40px);
    color: #e63946;
    letter-spacing: 2px;
    cursor: pointer;
    text-shadow: 2px 2px 0 rgba(0,0,0,0.3);
    transition: transform 0.2s;
    padding: 16px 24px;
    min-height: 52px;
    touch-action: manipulation;
}

.next-btn:hover {
    transform: scale(1.1);
}

.next-btn:active {
    transform: scale(0.95);
}

/* ============================================
   SCREEN 3: MAKE YOUR BET
   ============================================ */
.bet-bg {
    width: 100%;
    height: 100%;
    background: #1a1510;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
}

.speed-lines {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0; left: 0;
    pointer-events: none;
}

.speed-lines svg {
    width: 100%;
    height: 100%;
}

.bet-title {
    font-size: clamp(34px, 6.5vw, 64px);
    color: #f5a623;
    text-shadow: 3px 3px 0 #c0392b, -2px -2px 0 #c0392b, 2px 2px 4px rgba(0,0,0,0.5);
    position: relative;
    z-index: 5;
    margin-top: 16px;
    margin-bottom: 24px;
    text-align: center;
    letter-spacing: 2px;
}

.elevator-doors {
    display: flex;
    gap: clamp(15px, 4vw, 40px);
    justify-content: center;
    align-items: flex-end;
    position: relative;
    z-index: 5;
    padding: 0 20px;
}

.elevator-door {
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: transform 0.3s ease;
    min-width: 80px;
    min-height: 120px;
    padding: 12px;
    touch-action: manipulation;
}

.elevator-door:hover {
    transform: scale(1.05) translateY(-5px);
}

.elevator-door:active {
    transform: scale(0.97);
}

.elevator-num {
    font-family: 'Bangers', cursive;
    font-size: clamp(42px, 9vw, 80px);
    color: #fff;
    text-shadow: 2px 2px 0 #000, 1px 1px 2px rgba(0,0,0,0.6);
    margin-bottom: 8px;
    line-height: 1;
    letter-spacing: 1px;
}

.elevator-img {
    width: clamp(85px, 15vw, 140px);
    height: auto;
    display: block;
    object-fit: contain;
}

/* ============================================
   CONFIRM SCREENS (one per elevator, bg images)
   ============================================ */
.confirm-bg {
    width: 100%;
    height: 100%;
    min-height: 100%;
    position: relative;
    overflow: hidden;
}

.confirm-bg-1 { background: url('images/confirm1-bg.png') center center / cover no-repeat; }
.confirm-bg-2 { background: url('images/confirm2-bg.png') center center / cover no-repeat; }
.confirm-bg-3 { background: url('images/confirm3-bg.png') center center / cover no-repeat; }
.confirm-bg-4 { background: url('images/confirm4-bg.png') center center / cover no-repeat; }

.confirm-content {
    position: absolute;
    left: 21%;
    right: 21%;
    transform: translateY(-50%);
    z-index: 5;
    text-align: center;
    display: flex;
    justify-content: center;
    align-items: center;
}

#confirm1-screen .confirm-content { top: 72%; }
#confirm2-screen .confirm-content { top: 72%; }
#confirm3-screen .confirm-content { top: 82%; }
#confirm4-screen .confirm-content { top: 72%; }

#confirm1-screen .back-btn { bottom: 5%; color: rgba(255,255,255,0.9); }
#confirm2-screen .back-btn { bottom: 4%; color: rgba(255,255,255,0.9); }
#confirm3-screen .back-btn { bottom: 3%; color: #6E350B; text-shadow: 1px 1px 0 rgba(0,0,0,0.15); }
#confirm4-screen .back-btn { bottom: 2%; color: rgba(255,255,255,0.9); }

.yes-btn {
    margin-top: 8px;
    position: relative;
    background: none;
    border: none;
    cursor: pointer;
    font-family: 'Bangers', cursive;
    font-size: clamp(28px, 5vw, 48px);
    color: #e63946;
    filter: drop-shadow(2px 2px 0 #000);
    letter-spacing: 4px;
    padding: 10px 25px;
    transition: transform 0.2s;
}

.yes-btn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 120px;
    height: 80px;
    background: #f4a825;
    clip-path: polygon(
        50% 0%, 65% 15%, 85% 5%, 78% 25%, 100% 30%,
        82% 45%, 95% 65%, 75% 58%, 65% 80%, 55% 62%,
        40% 85%, 38% 62%, 20% 75%, 28% 52%, 5% 55%,
        22% 38%, 0% 25%, 25% 22%, 18% 5%, 38% 18%
    );
    z-index: -1;
    transition: transform 0.2s;
}

/* Confirm1: 蓝色星形背景 + 红色字体 */
#confirm1-screen .yes-btn {
    color: #e63946 !important;
    font-size: 36px;
    filter: drop-shadow(2px 4px 2px #000);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 0 0.25em 0;
    line-height: 1;
    transform: translateY(-28px);
}
#confirm1-screen .yes-btn::before {
    background: #384285;
    width: 130px;
    height: 98px;
    box-shadow: none;
}

/* Confirm2:*/
#confirm2-screen .yes-btn {
    color: #e63946 !important;
    font-size: 40px;
    filter: drop-shadow(2px 4px 2px #000);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 0 0.25em 0;
    line-height: 1;
    transform: translateY(-28px);
}
#confirm2-screen .yes-btn::before {
    background: #247b78;
    width: 130px;
    height: 98px;
    box-shadow: none;
}

/* Confirm3: 与 confirm1 相同 */
#confirm3-screen .yes-btn {
    color: #e63946 !important;
    font-size: 36px;
    filter: drop-shadow(2px 4px 2px #000);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 0 0.25em 0;
    line-height: 1;
    transform: translateY(-28px);
}
#confirm3-screen .yes-btn::before {
    background: #ffc851;
    width: 130px;
    height: 98px;
    box-shadow: none;
}

/* Confirm4: 与 confirm1 相同 */
#confirm4-screen .yes-btn {
    color: #ffc851 !important;
    font-size: 36px;
    filter: drop-shadow(2px 4px 2px #000);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 0 0.25em 0;
    line-height: 1;
    transform: translateY(-28px);
}
#confirm4-screen .yes-btn::before {
    background: #ef4a38;
    width: 130px;
    height: 98px;
    box-shadow: none;
}

.yes-btn:hover {
    transform: translateY(-28px) scale(1.15);
}

.yes-btn:hover::before {
    transform: translate(-50%, -50%) scale(1.2);
}

.yes-btn:active {
    transform: translateY(-28px) scale(0.95);
}

/* Back button on confirm screens */
.back-btn {
    position: absolute;
    bottom: max(5%, env(safe-area-inset-bottom, 12px));
    left: max(5%, env(safe-area-inset-left, 20px));
    z-index: 10;
    background: none;
    border: none;
    font-family: 'Bangers', cursive;
    font-size: clamp(18px, 3vw, 28px);
    color: rgba(255, 255, 255, 0.85);
    letter-spacing: 2px;
    cursor: pointer;
    text-shadow: 1px 1px 0 rgba(0,0,0,0.4);
    transition: transform 0.2s, color 0.2s;
    padding: 12px 20px;
    min-height: 48px;
    touch-action: manipulation;
}

.back-btn:hover {
    transform: scale(1.1);
    color: #fff;
}

#confirm3-screen .back-btn:hover {
    color: #8B4513;
}

.back-btn:active {
    transform: scale(0.95);
}

/* ============================================
   TRANSITION SCREEN (Confirm → Thanks)
   ============================================ */
.transition-bg {
    width: 100%;
    height: 100%;
    background: #2a2740;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
}

.transition-burst {
    position: absolute;
    inset: -20%;
    background: radial-gradient(circle at center, rgba(244, 196, 48, 0.25) 0%, transparent 60%);
    animation: transitionBurst 1.8s ease-out forwards;
}

@keyframes transitionBurst {
    0% { transform: scale(0); opacity: 1; }
    30% { transform: scale(1.5); opacity: 0.8; }
    100% { transform: scale(2); opacity: 0; }
}

.transition-elevator-img {
    position: relative;
    z-index: 5;
    max-width: 75vw;
    max-height: 70vh;
    object-fit: contain;
    animation: transitionPop 1.2s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    filter: drop-shadow(4px 6px 4px rgba(0,0,0,0.5));
}

@keyframes transitionPop {
    0% {
        transform: scale(0.3) rotate(-8deg);
        opacity: 0;
    }
    50% {
        transform: scale(1.15) rotate(2deg);
        opacity: 1;
    }
    70% {
        transform: scale(0.95) rotate(-1deg);
    }
    100% {
        transform: scale(1) rotate(0deg);
        opacity: 1;
    }
}

.transition-pow {
    position: absolute;
    bottom: 18%;
    left: 50%;
    transform: translateX(-50%);
    z-index: 6;
    font-family: 'Bangers', cursive;
    font-size: clamp(28px, 6vw, 52px);
    color: #f4c430;
    letter-spacing: 6px;
    text-shadow:
        3px 3px 0 #000,
        -1px -1px 0 #000,
        0 0 20px rgba(244, 196, 48, 0.6);
    animation: transitionPow 1.4s ease-out 0.3s both;
}

@keyframes transitionPow {
    0% {
        transform: translateX(-50%) scale(0.5);
        opacity: 0;
    }
    40% {
        transform: translateX(-50%) scale(1.2);
        opacity: 1;
    }
    60% {
        transform: translateX(-50%) scale(1);
    }
    100% {
        transform: translateX(-50%) scale(1);
        opacity: 1;
    }
}

/* ============================================
   SCREEN 7: THANKS FOR BETTING
   ============================================ */
.thanks-bg {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
    cursor: pointer;
    animation: thanksEnter 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

@keyframes thanksEnter {
    0% { opacity: 0; transform: scale(0.95); }
    100% { opacity: 1; transform: scale(1); }
}

/* Thanks -> Waiting transition */
#thanks-screen.thanks-exiting .thanks-bg {
    animation: thanksExit 0.45s ease-out forwards;
}

@keyframes thanksExit {
    0% { opacity: 1; transform: scale(1); }
    100% { opacity: 0; transform: scale(1.08); }
}

#waiting-screen.waiting-entering .waiting-bg {
    animation: waitingEnter 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

@keyframes waitingEnter {
    0% { opacity: 0; transform: scale(0.92); }
    100% { opacity: 1; transform: scale(1); }
}

/* Merged background image (red + starburst + text) */
.thanks-img-layer {
    position: absolute;
    inset: 0;
    z-index: 1;
    background: url('images/thanks-bg.png') center center / cover no-repeat;
}

/* Surrounding stars - not in bg image, with dynamic effects */
.thanks-star {
    position: absolute;
    fill: #3A2A22;
    z-index: 2;
    animation: thanksStarFloat 4s ease-in-out infinite;
    filter: drop-shadow(0 0 2px rgba(0,0,0,0.3));
}

.thanks-star-1 { width: 28px; top: 6%; left: 10%; animation-delay: 0s; }
.thanks-star-2 { width: 20px; top: 12%; right: 12%; animation-delay: 0.5s; }
.thanks-star-3 { width: 24px; bottom: 18%; left: 6%; animation-delay: 1s; }
.thanks-star-4 { width: 18px; bottom: 10%; right: 8%; animation-delay: 1.5s; }
.thanks-star-5 { width: 22px; top: 22%; left: 4%; animation-delay: 0.3s; }
.thanks-star-6 { width: 16px; top: 32%; right: 6%; animation-delay: 0.8s; }
.thanks-star-7 { width: 20px; bottom: 28%; left: 14%; animation-delay: 1.2s; }
.thanks-star-8 { width: 24px; bottom: 6%; right: 18%; animation-delay: 0.2s; }
.thanks-star-9 { width: 14px; top: 8%; right: 25%; animation-delay: 0.7s; }
.thanks-star-10 { width: 22px; bottom: 15%; left: 22%; animation-delay: 1.3s; }

@keyframes thanksStarFloat {
    0%, 100% {
        transform: rotate(0deg) scale(1);
        opacity: 1;
    }
    25% {
        transform: rotate(90deg) scale(1.15);
        opacity: 0.85;
    }
    50% {
        transform: rotate(180deg) scale(0.9);
        opacity: 1;
    }
    75% {
        transform: rotate(270deg) scale(1.08);
        opacity: 0.85;
    }
}

/* Varied animation timing for organic feel */
.thanks-star:nth-child(odd) {
    animation-duration: 3.5s;
}
.thanks-star:nth-child(3n) {
    animation-direction: reverse;
    animation-duration: 4.5s;
}
.thanks-star:nth-child(5n) {
    animation-duration: 3s;
}

/* Legacy starburst (results screen) */
.starburst {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0; left: 0;
}

.star-outer {
    fill: #e63946;
    stroke: #3a3520;
    stroke-width: 18;
}

.star-inner {
    fill: #f4c430;
}

/* ============================================
   SCREEN 7.5: WAITING FOR ELEVATOR
   ============================================ */
.waiting-bg {
    width: 100%;
    height: 100%;
    background: #1a4a4a url('images/waiting-bg.png') center 58% / cover no-repeat;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-end;
    position: relative;
    overflow: hidden;
}

.waiting-back-btn {
    position: absolute;
    top: max(20px, env(safe-area-inset-top));
    left: max(20px, env(safe-area-inset-left));
    z-index: 10;
    background: none;
    border: none;
    font-family: 'Bangers', cursive;
    font-size: clamp(18px, 3vw, 26px);
    color: rgba(244, 196, 48, 0.95);
    letter-spacing: 2px;
    cursor: pointer;
    text-shadow: 1px 1px 0 rgba(0,0,0,0.5);
    transition: transform 0.2s, color 0.2s;
    padding: 10px 16px;
    touch-action: manipulation;
}
.waiting-back-btn:hover {
    transform: scale(1.08);
    color: #f4c430;
}
.waiting-back-btn:active {
    transform: scale(0.95);
}

.waiting-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 8%;
}

.waiting-count-wrap {
    position: relative;
    margin-bottom: 2px;
    margin-top: 24px;
}

.waiting-count-wrap::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 100%;
    min-width: 220px;
    height: 56px;
    background: #e63946;
    border: 4px solid #1a1a1a;
    clip-path: polygon(
        8% 0%, 25% 5%, 45% 0%, 65% 5%, 85% 0%, 100% 8%,
        95% 25%, 100% 45%, 95% 65%, 100% 85%, 95% 100%,
        75% 95%, 55% 100%, 35% 95%, 15% 100%, 0% 92%,
        5% 75%, 0% 55%, 5% 35%, 0% 15%
    );
    z-index: -1;
}

.waiting-count-wrap::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: calc(100% - 16px);
    min-width: 204px;
    height: 44px;
    background: #2a9d8f;
    border: 2px solid #1a1a1a;
    clip-path: polygon(
        10% 2%, 28% 6%, 48% 2%, 68% 6%, 88% 2%, 98% 10%,
        94% 28%, 98% 48%, 94% 68%, 98% 88%, 92% 98%,
        72% 94%, 52% 98%, 32% 94%, 12% 98%, 2% 90%,
        6% 70%, 2% 50%, 6% 30%, 2% 10%
    );
    z-index: -1;
}

.waiting-count {
    font-family: 'Bangers', cursive;
    font-size: clamp(20px, 3.5vw, 32px);
    color: #f4c430;
    letter-spacing: 3px;
    text-shadow: 2px 2px 0 #000;
    padding: 12px 28px;
    margin: 0;
    animation: waitingCountBlink 1.5s ease-in-out 0.6s infinite;
}

@keyframes waitingCountBlink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

/* JOIN BET button - dark blue spiky burst, yellow text (ref: second image) */
.join-btn {
    position: relative;
    background: none;
    border: none;
    padding: 14px 36px;
    margin-top: 8px;
    font-family: 'Bangers', cursive;
    font-size: clamp(22px, 4vw, 38px);
    color: #f4c430;
    letter-spacing: 4px;
    cursor: pointer;
    filter: drop-shadow(3px 3px 0 #000);
    transition: transform 0.2s;
    z-index: 1;
}

.join-btn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 190px;
    height: 95px;
    background: #2a2a7e;
    border: 4px solid #1a1a4a;
    clip-path: polygon(
        50% 0%, 63% 12%, 80% 2%, 77% 20%, 97% 18%,
        85% 33%, 100% 45%, 83% 52%, 95% 68%, 78% 65%,
        85% 82%, 68% 75%, 62% 95%, 52% 78%, 40% 98%,
        35% 78%, 20% 90%, 25% 72%, 8% 75%, 18% 58%,
        0% 52%, 15% 42%, 3% 28%, 20% 28%, 12% 12%,
        30% 18%, 38% 2%
    );
    z-index: -1;
    transition: transform 0.2s;
}

.join-btn:hover {
    transform: scale(1.08);
}

.join-btn:hover::before {
    transform: translate(-50%, -50%) scale(1.05);
}

.join-btn:active {
    transform: scale(0.95);
}

.join-btn.room-full {
    opacity: 0.6;
    cursor: not-allowed;
    pointer-events: none;
}

/* ============================================
   SCREEN 8: RESULTS (Multi-player)
   Background: result-bg.png (yellow-orange + rank QR on right)
   ============================================ */
.results-bg {
    width: 100%;
    height: 100%;
    background: #e8a030 url('images/result-bg.png') center center / cover no-repeat;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    position: relative;
    overflow: hidden;
}

.results-overlay {
    position: relative;
    z-index: 5;
    text-align: center;
    max-width: 55%;
    width: 55%;
    max-height: 85%;
    overflow-y: auto;
    padding: 20px 5% 20px 8%;
    margin-left: 0;
}

.results-title {
    font-size: clamp(32px, 6vw, 56px);
    color: #c0392b;
    text-shadow: 3px 3px 0 #1a1a1a, -1px -1px 0 #1a1a1a;
    margin-bottom: 8px;
}

.results-content-area {
    text-align: center;
}

.results-elevator {
    font-family: 'Bangers', cursive;
    font-size: clamp(14px, 2.8vw, 24px);
    color: #2c3e50;
    letter-spacing: 2px;
    text-shadow: 1px 1px 0 rgba(255,255,255,0.5);
    margin-bottom: 12px;
}

.results-section {
    margin-bottom: 10px;
}

.results-section-title {
    font-family: 'Bangers', cursive;
    font-size: clamp(18px, 3.2vw, 28px);
    letter-spacing: 2px;
    text-shadow: 2px 2px 0 rgba(0,0,0,0.3);
    margin-bottom: 6px;
}

.results-win-title { color: #27ae60; text-shadow: 2px 2px 0 #1a1a1a; }
.results-lose-title { color: #c0392b; font-size: clamp(14px, 2.2vw, 20px); text-shadow: 1px 1px 0 #1a1a1a; }

.results-player {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    margin: 3px 6px;
    padding: 5px 12px;
    border-radius: 8px;
    font-family: 'Bangers', cursive;
    letter-spacing: 1px;
}

.results-player-win {
    background: rgba(39, 174, 96, 0.35);
    border: 2px solid #27ae60;
}

.results-player-lose {
    background: rgba(192, 57, 43, 0.25);
    border: 2px solid rgba(192, 57, 43, 0.6);
}

.results-player-name {
    font-size: clamp(14px, 2.2vw, 18px);
    color: #2c3e50;
}

.results-player-bet {
    font-size: clamp(11px, 1.6vw, 14px);
    color: rgba(44, 62, 80, 0.8);
}

.results-total {
    font-family: 'Bangers', cursive;
    font-size: clamp(12px, 1.8vw, 16px);
    color: rgba(44, 62, 80, 0.7);
    letter-spacing: 2px;
    margin-top: 8px;
}

.results-qr-code {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 16px;
    margin-top: 16px;
    padding-top: 12px;
    border-top: 2px solid rgba(44, 62, 80, 0.2);
}

.results-qr-code > div {
    text-align: center;
}

.see-more-btn {
    position: absolute;
    bottom: 25px;
    right: 35px;
    z-index: 10;
    background: none;
    border: none;
    font-family: 'Bangers', cursive;
    font-size: clamp(20px, 3.5vw, 34px);
    color: #f4a825;
    letter-spacing: 2px;
    cursor: pointer;
    text-shadow: 1px 1px 0 rgba(0,0,0,0.5);
    transition: transform 0.2s;
}

.see-more-btn:hover {
    transform: scale(1.1);
}

.see-more-btn:active {
    transform: scale(0.95);
}

.results-reset-btn {
    bottom: 12px;
    right: 15px;
    font-size: clamp(14px, 2.5vw, 22px);
    color: #c0392b;
    text-shadow: 2px 2px 0 #1a1a1a, 1px 1px 0 rgba(0,0,0,0.5);
}

/* ============================================
   IDLE OVERLAY - 背景图 + 右下角倒计时
   ============================================ */
.idle-overlay {
    position: absolute;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    z-index: 100;
    cursor: pointer;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.35s ease, visibility 0.35s ease;
}

.idle-overlay.active {
    opacity: 1;
    visibility: visible;
}

#idle-overlay {
    background: #f8f6f0 url('images/idle-bg.png') center center / cover no-repeat;
}

#idle-betting-overlay {
    background: #ffffff url('images/idle-bg.png') center center / cover no-repeat;
}

.idle-countdown {
    position: absolute;
    bottom: 6%;
    right: 8%;
    font-family: 'Bangers', cursive;
    font-size: clamp(56px, 12vw, 100px);
    color: #e63946;
    -webkit-text-stroke: 3px #000;
    text-shadow: 4px 4px 0 #000;
    letter-spacing: 4px;
}

/* Bet screen back button - top-left, same height as MAKE YOUR BET, same color, same animation */
.bet-back-btn {
    top: max(5%, env(safe-area-inset-top, 24px));
    bottom: auto;
    left: max(5%, env(safe-area-inset-left, 20px));
    color: #f5a623;
    text-shadow: 3px 3px 0 #c0392b, -2px -2px 0 #c0392b, 2px 2px 4px rgba(0,0,0,0.5);
    font-size: clamp(14px, 2.5vw, 22px);
    transition: transform 0.3s ease, color 0.2s;
}
.bet-back-btn:hover {
    color: #ffb84d;
    transform: scale(1.05) translateY(-5px);
}
.bet-back-btn:active {
    transform: scale(0.97);
}

/* ============================================
   ANIMATIONS
   ============================================ */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideUp {
    from { opacity: 0; transform: translateY(40px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes popIn {
    0% { opacity: 0; transform: scale(0.3); }
    60% { transform: scale(1.1); }
    100% { opacity: 1; transform: scale(1); }
}

@keyframes shake {
    0%, 100% { transform: translateX(0); }
    25% { transform: translateX(-5px); }
    75% { transform: translateX(5px); }
}

.screen.active .comic-title {
    animation: popIn 0.5s ease forwards;
}

#bet-screen.active .bet-back-btn {
    animation: popIn 0.5s ease forwards;
}

.screen.active .comic-subtitle {
    animation: fadeIn 0.6s ease 0.3s forwards;
    opacity: 0;
}

#start-screen.active .start-subtitle {
    animation: blink 1.8s ease-in-out infinite !important;
}

.screen.active .elevator-doors {
    animation: slideUp 0.6s ease 0.2s forwards;
    opacity: 0;
}

.screen.active .confirm-content {
    animation: popIn 0.4s ease forwards;
}

.screen.active .name-content {
    animation: popIn 0.5s ease forwards;
}

/* Door hover glow effect */
/* Selected elevator indicator */
.elevator-door.selected .elevator-img {
    box-shadow: 0 0 0 4px #f4a825, 0 0 20px rgba(244, 168, 37, 0.6);
}

/* ============================================
   RESPONSIVE - 800x400 display
   ============================================ */
@media (max-width: 800px) {
    .start-title { font-size: 100px; }
    .bet-title { font-size: 55px; }
    .thanks-title { font-size: 70px; }
    .results-title { font-size: 50px; }
    
    .elevator-img { width: 110px; }
    .elevator-doors { gap: 12px; }
    
    
    .animal-options { gap: 8px; }
    .animal-btn { padding: 10px 18px; font-size: 16px; }
}

@media (max-height: 500px) {
    .elevator-img { width: 100px; }
    .bet-title {
        margin-bottom: 25px;
    }
    .ranking-bg { padding: 15px 20px; }
}

/* ============================================
   STATS PAGE STYLES
   ============================================ */
.stats-page {
    width: 100%;
    min-height: 100vh;
    background: #3a3520;
    padding: 30px 40px;
    overflow-y: auto;
}

.stats-header {
    text-align: center;
    margin-bottom: 30px;
}

.stats-main-title {
    font-family: 'Bangers', cursive;
    font-size: clamp(30px, 6vw, 56px);
    color: #f4a825;
    letter-spacing: 3px;
    -webkit-text-stroke: 2px #000;
    text-shadow: 3px 3px 0 #000;
    text-transform: uppercase;
}

.stats-title-underline {
    width: 60%;
    max-width: 500px;
    height: 8px;
    margin: 8px auto 0;
    background: linear-gradient(90deg, #e63946, #2a2a7e, #f4c430);
    border-radius: 4px;
}

.stats-nav {
    display: flex;
    gap: 20px;
    margin-bottom: 30px;
}

.stats-nav-badge {
    display: inline-block;
    font-family: 'Bangers', cursive;
    font-size: clamp(14px, 2vw, 20px);
    color: #f4a825;
    letter-spacing: 2px;
    padding: 8px 15px;
    cursor: pointer;
    position: relative;
    transition: transform 0.2s;
}

.stats-nav-badge::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 120%;
    height: 150%;
    z-index: -1;
}

.stats-nav-badge.active-badge {
    color: #fff;
}

.stats-nav-badge:hover {
    transform: scale(1.1);
}

.stats-charts {
    display: flex;
    flex-direction: column;
    gap: 30px;
}

.chart-section {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.stats-bar-row {
    display: flex;
    align-items: center;
    gap: 12px;
}

.stats-bar-label {
    width: 60px;
    font-family: 'Bangers', cursive;
    font-size: 18px;
    color: #fff;
    text-align: right;
}

.stats-bar-track {
    flex: 1;
    height: 35px;
    background: rgba(255,255,255,0.1);
    border-radius: 3px;
    overflow: hidden;
    position: relative;
}

.stats-bar-fill {
    height: 100%;
    border-radius: 3px;
    transition: width 0.8s ease;
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding-right: 8px;
    font-family: 'Bangers', cursive;
    font-size: 14px;
    color: #fff;
    text-shadow: 1px 1px 0 rgba(0,0,0,0.5);
}

.stats-bar-blue { background: #2a2a7e; }
.stats-bar-red { background: #e63946; }
.stats-bar-yellow { background: #f4c430; color: #333 !important; text-shadow: none !important; }
.stats-bar-teal { background: #2a9d8f; }

/* ============================================
   MOBILE OPTIMIZATION
   ============================================ */
@media (hover: none) and (pointer: coarse) {
    .elevator-door:hover { transform: none; }
    .elevator-door:active { transform: scale(0.97); }
    .next-btn:hover { transform: none; }
    .back-btn:hover { transform: none; }
}
